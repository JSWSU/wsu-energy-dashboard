DATA DICTIONARY
===============

Complete field-by-field reference for data.json -- the data payload that powers the WSU Energy Dashboard.


OVERVIEW
--------

- Generated by: ExportDataJSON.bas VBA macro in the Excel workbook
- Consumed by: index.html JavaScript (fetched via fetch('data.json'))
- Array convention: All 12-element arrays follow fiscal year order:
    Index 0 = July, 1 = August, 2 = September, ... 11 = June
- Dollar values: Rounded integers (no cents)
- MMBTU values: Rounded integers
- Percentage values: Stored as floats (e.g., 8.7 means 8.7%, not 0.087)
- Rate values: Stored with decimal precision (2 or 4 decimal places)


TOP-LEVEL STRUCTURE
-------------------

{
  "lastUpdated": string,
  "fy26": { ... },          FY2026 actual and forecast costs
  "fy25gas": { ... },       FY2025 gas analysis
  "energyUse": { ... },     FY2026 energy consumption (MMBTU, kWh)
  "yoy": { ... },           Year-over-year MMBTU comparison
  "cumul": { ... },         Cumulative running totals
  "variance": { ... },      Price vs volume variance with HDD
  "hdd": { ... },           Heating degree day data
  "kintec": { ... },        Kintec gas delivery history
  "verification": { ... }   Cross-check data from Consolidated Data sheet
}


lastUpdated
-----------

Type:      String
Format:    "mmmm d, yyyy" (e.g., "February 18, 2026")
Source:    VBA Format(Now, "mmmm d, yyyy") at export time
Used in:   Header subtitle ("Last Updated: ..."), footer


fy26 -- FY2026 Actuals & Forecasts
-----------------------------------

Source: "Executive Summary (Print)" sheet, rows 3-14, columns B-K

Field           Type        Unit    Excel Col   Description                              Dashboard Usage
-----------     --------    ----    ---------   -----------                              ---------------
totalActual     int[12]     USD     B (2)       Total actual energy cost per month        KPI "Actual + Forecast", Monthly Detail table, bar chart
elecActual      int[12]     USD     C (3)       Electric actual cost per month            KPI "Electric Cost", breakdown chart, pie chart
gasActual       int[12]     USD     D (4)       Gas actual cost per month                 KPI "Gas Cost", breakdown chart
totalFcast      int[12]     USD     E (5)       Total forecast cost per month             KPI "Forecast", bar chart overlay
elecFcast       int[12]     USD     F (6)       Electric forecast cost per month          Monthly Detail table
gasFcast        int[12]     USD     G (7)       Gas forecast total per month              Monthly Detail table
kintecFcast     int[12]     USD     H (8)       Kintec gas commodity forecast per month   Monthly Detail table, pie chart
avistaFcast     int[12]     USD     I (9)       Avista gas distribution forecast per month Monthly Detail table, pie chart
hedge           float       %       K (11)      Price hedge / contingency percentage       Monthly Detail table
                                    row 3 only

Notes:
- If the hedge value in Excel is < 1 (stored as decimal, e.g., 0.10), the VBA macro automatically multiplies by 100 to normalize to percentage form.
- totalActual = elecActual + gasActual for months with actuals. For forecast-only months, totalActual equals totalFcast.
- The dashboard determines which months are "actual" vs "forecast" by comparing totalActual[i] !== totalFcast[i].


fy25gas -- FY2025 Gas Analysis
-------------------------------

Source: "Executive Summary (Print)" sheet, rows 21-32, columns B-I

Field       Type          Unit      Excel Col   Description
-----       ----          ----      ---------   -----------
cost        int[12]       USD       B (2)       FY2025 gas cost actual per month
mmbtu       int[12]       MMBTU     C (3)       FY2025 gas MMBTU actual per month
perUnit     float[12]     $/MMBTU   D (4)       FY2025 gas unit cost (2 decimal places)
kintec      int[12]       USD       H (8)       Kintec portion of gas cost
avista      int[12]       USD       I (9)       Avista portion of gas cost

Notes:
- cost[i] should approximately equal kintec[i] + avista[i]
- perUnit[i] = cost[i] / mmbtu[i]


energyUse -- FY2026 Energy Consumption
---------------------------------------

Source: "Executive Summary (Print)" sheet, rows 39-50, columns B-J

Field         Type          Unit    Excel Col   Description
-----         ----          ----    ---------   -----------
totalActual   int[12]       MMBTU   B (2)       Total energy consumption actual
elecActual    int[12]       MMBTU   C (3)       Electric consumption in MMBTU
gasActual     int[12]       MMBTU   D (4)       Gas consumption in MMBTU
totalFcast    int[12]       MMBTU   E (5)       Total energy consumption forecast
kwhActual     int[12]       kWh     H (8)       Total kilowatt-hours actual
kwhRate       float[12]     $/kWh   J (10)      Average electricity rate per kWh (4 decimal places)

Notes:
- totalActual[i] = elecActual[i] + gasActual[i]
- MMBTU = Million BTU. Electric MMBTU is converted from kWh (1 kWh = 0.003412 MMBTU).
- kwhRate[i] = fy26.elecActual[i] / kwhActual[i]


yoy -- Year-over-Year MMBTU Comparison
----------------------------------------

Source: "Executive Summary (Print)" sheet, rows 57-68, columns B-G

Field       Type      Unit    Excel Col   Description
-----       ----      ----    ---------   -----------
fy25total   int[12]   MMBTU   B (2)       FY2025 total MMBTU per month
fy25elec    int[12]   MMBTU   C (3)       FY2025 electric MMBTU per month
fy25gas     int[12]   MMBTU   D (4)       FY2025 gas MMBTU per month
fy26total   int[12]   MMBTU   E (5)       FY2026 total MMBTU per month
fy26elec    int[12]   MMBTU   F (6)       FY2026 electric MMBTU per month
fy26gas     int[12]   MMBTU   G (7)       FY2026 gas MMBTU per month

Notes:
- fy26total, fy26elec, fy26gas values should match energyUse.totalActual, energyUse.elecActual, energyUse.gasActual respectively.
- Used in the Year-over-Year tab's line chart and table.


cumul -- Cumulative Summary
----------------------------

Source: "Executive Summary (Print)" sheet, rows 74-85, columns B-I

Field           Type          Unit    Excel Col   Description
-----           ----          ----    ---------   -----------
actual          int[12]       USD     B (2)       Cumulative actual cost through each month
forecast        int[12]       USD     C (3)       Cumulative forecast cost through each month
delta           int[12]       USD     D (4)       Forecast minus actual (positive = under budget)
deltaPct        float[12]     %       E (5)       Delta as percentage
mmbtuAct        int[12]       MMBTU   F (6)       Cumulative actual MMBTU
mmbtuFcast      int[12]       MMBTU   G (7)       Cumulative forecast MMBTU
mmbtuDelta      int[12]       MMBTU   H (8)       MMBTU delta (actual minus forecast)
mmbtuDeltaPct   float[12]     %       I (9)       MMBTU delta percentage

Notes:
- These are RUNNING TOTALS, not per-month values. actual[5] is the sum of months 0-5 (Jul through Dec).
- delta[i] = forecast[i] - actual[i]. Positive means under budget.
- The dashboard uses delta[lastActualMonth] for the "Forecast vs Actual" KPI card.
- The dashboard uses deltaPct read via ReadRowPct which auto-detects Excel % format.


variance -- Price vs Volume Variance
--------------------------------------

Source: "Executive Summary (Print)" sheet, rows 127-138, columns B-L

Field           Type          Unit    Excel Col   Description
-----           ----          ----    ---------   -----------
fy25cost        int[12]       USD     B (2)       FY2025 total cost per month
fy26cost        int[12]       USD     C (3)       FY2026 total cost per month
costDelta       int[12]       USD     D (4)       Cost variance (FY26 - FY25)
fy25mmbtu       int[12]       MMBTU   E (5)       FY2025 MMBTU per month
fy26mmbtu       int[12]       MMBTU   F (6)       FY2026 MMBTU per month
mmbtuDelta      int[12]       MMBTU   G (7)       Volume variance in MMBTU
mmbtuDeltaPct   float[12]     %       H (8)       MMBTU delta percentage
fy25hdd         int[12]       HDD     I (9)       FY2025 heating degree days
fy26hdd         int[12]       HDD     J (10)      FY2026 heating degree days
hddDeltaPct     int[12]       %       K (11)      HDD delta percentage
normalHdd       int[12]       HDD     L (12)      30-year normal HDD (1991-2020)

Notes:
- hddDeltaPct is read via ReadRowPctText because this column may contain text-formatted percentages like "350%" or "(94%)" where parentheses indicate negative values.
- HDD = Heating Degree Days. Higher HDD = colder weather = more heating energy needed.


hdd -- Heating Degree Days
---------------------------

Source: "HDD Data" sheet, rows 6-17, columns C-E

Field     Type      Unit    Excel Col   Description
-----     ----      ----    ---------   -----------
fy25      int[12]   HDD     C (3)       FY2025 heating degree days per month
fy26      int[12]   HDD     D (4)       FY2026 heating degree days per month
normal    int[12]   HDD     E (5)       30-year normal (1991-2020) per month

Notes:
- Source station: NWS Spokane (KOTX) for Pullman-Moscow Airport (KPUW) via NOAA ACIS API.
- HDD = number of degrees below 65 degrees F, summed per day across the month.
- Forecast months use 30-year normals until actual data is published.
- hdd.fy25 and hdd.fy26 should match variance.fy25hdd and variance.fy26hdd.


kintec -- Kintec Gas Delivery History
--------------------------------------

Source: "Kintec Data" sheet, rows 2 through last non-empty row

Field     Type        Unit    Excel Col   Description
-----     ----        ----    ---------   -----------
months    string[N]   --      A (1)       Month labels formatted "MMM-YY" (e.g., "Jan-23")
dths      int[N]      Dth     F (6)       Total dekatherms (usage) per month
cost      int[N]      USD     E (5)       Total bill amount per month

Notes:
- Variable length -- currently 36 months (Jan 2023 through Dec 2025), grows as new invoices are added.
- Dekatherms (Dth) are approximately equal to MMBTU for natural gas.
- This is historical data used for the Kintec delivery chart on the Gas Analysis tab.
- The VBA macro uses a dynamic loop (For i = 2 To lastRow) unlike the fixed 12-row ranges for other sections.


verification -- Cross-Check Data
----------------------------------

Source: "Consolidated Data" sheet, summed by FY2026 month

Field       Type      Unit    Description
-----       ----      ----    -----------
source      string    --      Always "Consolidated Data"
elecDollar  int[12]   USD     Sum of electric dollar amounts per month from all line items
gasDollar   int[12]   USD     Sum of gas dollar amounts per month
kwh         int[12]   kWh     Sum of kilowatt-hours per month
elecMmbtu   int[12]   MMBTU   Sum of electric MMBTU per month
gasMmbtu    int[12]   MMBTU   Sum of gas MMBTU per month

Consolidated Data sheet columns used:

Data                  Excel Col
----                  ---------
Source identifier     A (1)
Month-Year date       N (14)
kWh                   H (8)
Electric $            J (10)
Gas $                 K (11)
Electric MMBTU        O (15)
Gas MMBTU             P (16)

Notes:
- Months with zero values indicate no billing data has been entered yet (future/forecast months).
- The VBA macro compares these sums against "Executive Summary (Print)" values and warns if any month differs by more than 5%.
- Minor differences are expected due to adjustments, credits, and rounding not reflected in raw consolidated data.
- The dashboard shows a "Verified vs Consolidated Data" badge in the header when this data is present.
