OPERATIONS RUNBOOK -- Monthly Data Update
==========================================

Step-by-step guide for updating the WSU Energy Dashboard with new monthly data. Written for someone with no development background.


OVERVIEW
--------

What this covers: The monthly cycle of updating energy data and publishing it to the web dashboard.

Frequency: Monthly, after all utility bills for the prior month have been received and entered into the Excel workbook.

Time required: ~10 minutes.


PREREQUISITES
-------------

Before you begin, make sure you have:

[ ] Access to the Excel workbook ("WSU Energy Cost Projection - FY2026.xlsx" or similar)
[ ] Excel 2016 or later with macros enabled (see Troubleshooting guide if macros are blocked)
[ ] A GitHub account with push access to https://github.com/JSWSU/wsu-energy-dashboard
[ ] (Optional) Git installed locally, OR the ability to upload files via the GitHub website


STEP-BY-STEP: MONTHLY DATA UPDATE
-----------------------------------

Step 1: Verify Excel Data Is Current
.....................................

1. Open the Excel workbook
2. Go to the "Executive Summary (Print)" sheet
3. Confirm the latest month's actuals are filled in:
   - Rows 3-14 = July 2025 through June 2026
   - Row 3 = July, Row 4 = August, ..., Row 14 = June
   - Columns B-D should have actual values (Total, Electric, Gas) for completed months
4. Check the "HDD Data" sheet has the latest Heating Degree Day values (rows 6-17)
5. Check the "Kintec Data" sheet has the latest gas invoice row at the bottom


Step 2: Run the Export Macro
............................

Option A -- Click the button:
1. On the "Executive Summary (Print)" sheet, find the crimson "Export data.json" button (usually near cell M2)
2. Click it

Option B -- Run from the Macros menu:
1. Press Alt+F8
2. Select ExportDataJSON.ExportDataJSON
3. Click Run

Wait for the completion dialog box to appear (usually 2-5 seconds).


Step 3: Review the Verification Results
........................................

The macro will show a message box with:

- File path where data.json was saved (same folder as the workbook)
- Number of months cross-checked against the Consolidated Data sheet
- Any discrepancies exceeding 5%

What discrepancies mean:
- Minor differences (<5%) are normal -- adjustments, credits, and rounding often cause small mismatches between the Executive Summary and Consolidated Data
- If a discrepancy exceeds 10-15%, investigate the source data:
  - Is a bill missing from Consolidated Data?
  - Was an adjustment made to the Executive Summary but not to Consolidated Data?
  - Was a bill entered for the wrong month?

If everything looks OK, proceed to Step 4.


Step 4: Upload data.json to GitHub
...................................

Choose one of the two methods below:

Method A: GitHub Web Upload (No Git Required)

1. Open your web browser and go to https://github.com/JSWSU/wsu-energy-dashboard
2. Click on data.json in the file list
3. Click the pencil icon (edit) in the top-right corner of the file view
4. Select all the content (Ctrl+A) and delete it
5. Open the newly exported data.json file in Notepad (or any text editor)
6. Select all (Ctrl+A), copy (Ctrl+C), and paste (Ctrl+V) into the GitHub editor
7. Scroll down to "Commit changes"
8. Write a commit message like: Update data.json for December 2025
9. Make sure "Commit directly to the main branch" is selected
10. Click "Commit changes"

Method B: Git Command Line

1. Open a terminal/command prompt
2. Navigate to your local clone of the repository:
   cd C:\Users\john.slagboom\Desktop\Git
3. Copy the new data.json from the workbook folder into the repo folder (if it's not already there)
4. Stage, commit, and push:
   git add data.json
   git commit -m "Update data.json for December 2025"
   git push origin main


Step 5: Verify the Live Site
............................

1. Wait 1-2 minutes for GitHub Pages to deploy
2. Open https://jswsu.github.io/wsu-energy-dashboard/
3. Enter password: Energy@WSU
4. Check these things:
   [ ] "Last Updated" date in the header matches the export date
   [ ] The "Verified vs Consolidated Data" badge is visible
   [ ] KPI values on the Dashboard tab look reasonable
   [ ] Spot-check a few numbers against the Excel workbook (e.g., the latest month's total actual cost)
5. If something looks wrong, see the Troubleshooting guide


FISCAL YEAR ROLLOVER PROCEDURE
-------------------------------

When: At the start of each new fiscal year (July 1).

Who: A developer or someone comfortable editing code. This is NOT part of the monthly routine.

What to change:


1. VBA Macro (ExportDataJSON.bas)

Update the hardcoded FY2026 month dates in the verification section (lines 210-222):

Change FROM:
   fy26Months(1) = DateSerial(2025, 7, 1)   ' July 2025
   ...
   fy26Months(12) = DateSerial(2026, 6, 1)  ' June 2026

Change TO:
   fy26Months(1) = DateSerial(2026, 7, 1)   ' July 2026
   ...
   fy26Months(12) = DateSerial(2027, 6, 1)  ' June 2027


2. Web App (index.html)

Update these locations:

What                    Where                          Change From                  Change To
----                    -----                          -----------                  ---------
Page title              <title> tag (line 6)           "FY2026"                     "FY2027"
Header title            <h1> in <header>               "FY2026"                     "FY2027"
Header subtitle         <p> in header                  "July 2025 -- June 2026"     "July 2026 -- June 2027"
Month labels            MONTH_FULL array in JS         "July 2025" thru "June 2026" "July 2026" thru "June 2027"
Print summary header    #printSummary .ps-header       "FY2026"                     "FY2027"
Footer                  <footer> text                  "FY2026"                     "FY2027"


3. Excel Workbook

The workbook itself needs its data ranges updated for the new fiscal year. This is specific to however the workbook is structured -- consult the workbook's creator or documentation.


PRINTABLE CHECKLIST
-------------------

Cut this out and tape it to your desk:

WSU Energy Dashboard -- Monthly Update Checklist

Date: _______________  Month being added: _______________

[ ] 1. Open Excel workbook
[ ] 2. Verify latest month's actuals are entered on "Executive Summary (Print)"
[ ] 3. Verify "HDD Data" sheet is current
[ ] 4. Verify "Kintec Data" sheet has latest invoice
[ ] 5. Click "Export data.json" button
[ ] 6. Review verification message -- note any discrepancies:
      ____________________________________________
[ ] 7. Upload data.json to GitHub (web or git push)
[ ] 8. Wait 1-2 minutes for deployment
[ ] 9. Open live site and verify:
      [ ] "Last Updated" date is correct
      [ ] "Verified" badge is showing
      [ ] KPI values look right
[ ] 10. Done!

Notes: ____________________________________________
