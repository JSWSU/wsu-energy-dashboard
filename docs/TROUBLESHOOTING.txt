TROUBLESHOOTING GUIDE
=====================

Quick-reference for common problems with the WSU Energy Dashboard. Organized as Symptom > Cause > Solution.


DASHBOARD SHOWS "COULD NOT LOAD DATA"
--------------------------------------

Cause: data.json is missing from the GitHub repository, or the file is malformed.

Solution:
1. Go to https://github.com/JSWSU/wsu-energy-dashboard and verify data.json exists
2. If missing: re-run the export macro in Excel and upload data.json to GitHub
3. If present: open data.json in a text editor -- check for JSON syntax errors (missing commas, brackets, etc.)
4. Validate the JSON at https://jsonlint.com/


VBA MACRO FAILS WITH "SUBSCRIPT OUT OF RANGE"
----------------------------------------------

Cause: One of the required Excel sheets is missing or its name does not match exactly.

Solution: Verify all 4 required sheets exist with exact names (case-sensitive, no trailing spaces):
- Executive Summary (Print)
- HDD Data
- Kintec Data
- Consolidated Data

Right-click each sheet tab to confirm the name. Even a trailing space will cause this error.


VBA MACRO FAILS WITH "PERMISSION DENIED"
-----------------------------------------

Cause: The output file (data.json) is open in another program, or the workbook folder is read-only.

Solution:
1. Close any other editors (Notepad, VS Code, etc.) that have data.json open
2. Verify you have write permissions to the workbook's folder
3. If on a network share, check that the share isn't read-only


VERIFICATION SHOWS LARGE DISCREPANCIES (>5%)
---------------------------------------------

Cause: Billing adjustments, credits, data entry timing, or errors between the Executive Summary and Consolidated Data sheets.

Solution:
1. Note which specific months are flagged in the message box
2. Compare the flagged month's values in "Executive Summary (Print)" against line items in "Consolidated Data"
3. Common reasons for discrepancies:
   - A bill was entered in Consolidated Data but not yet reflected in Executive Summary (or vice versa)
   - An adjustment or credit was applied to one sheet but not the other
   - A bill was assigned to the wrong month
4. If the discrepancy is <10% and you understand the reason, it's safe to proceed
5. If >10% or unexplained, resolve the data issue before publishing


"LAST UPDATED" DATE IS STALE
------------------------------

Cause: Either the export macro was not run recently, or the updated data.json was not pushed to GitHub.

Solution:
1. Re-run the export macro (it stamps the current date automatically)
2. Upload the new data.json to GitHub
3. Wait 1-2 minutes for GitHub Pages to deploy
4. Hard-refresh the browser (Ctrl+Shift+R)


CHARTS LOOK WRONG IN DARK MODE
--------------------------------

This issue was fixed in February 2026. Charts now automatically update their text and grid colors when dark mode is toggled. If charts still look wrong:

1. Hard-refresh the page (Ctrl+Shift+R) to ensure you have the latest version of index.html
2. If the problem persists, clear the browser cache entirely


PASSWORD NOT WORKING
---------------------

Cause: The password is case-sensitive.

Solution: Enter exactly: Energy@WSU
- Capital E in Energy
- Capital W, S, U in WSU
- @ symbol between Energy and WSU

To change the password:
1. Open index.html
2. Find the line: if (input.value === 'Energy@WSU')
3. Replace Energy@WSU with the new password
4. Commit and push to GitHub
5. Communicate the new password to all authorized users


GITHUB PAGES NOT UPDATING AFTER PUSH
--------------------------------------

Cause: GitHub Pages can take 1-5 minutes to rebuild. Occasionally the CDN caches stale content.

Solution:
1. Wait 5 minutes
2. Hard-refresh the browser: Ctrl+Shift+R (Windows) or Cmd+Shift+R (Mac)
3. Check deployment status: go to the GitHub repo > Settings > Pages -- look for "Your site is live"
4. If using a custom domain (not applicable currently), check DNS propagation


MACROS ARE DISABLED / TRUST CENTER ERROR
------------------------------------------

Cause: Excel's default security settings block VBA macros.

Solution:
1. Go to File > Options > Trust Center > Trust Center Settings > Macro Settings
2. Select "Disable VBA macros with notification" (recommended) or "Enable all macros"
3. Click OK, close and reopen the workbook
4. If using "with notification": click "Enable Content" in the yellow security banner when prompted


EXPORT BUTTON IS MISSING FROM EXCEL
-------------------------------------

Cause: The button was never created, or the sheet was renamed/recreated.

Solution:
1. Press Alt+F8 to open the Macros dialog
2. Select ExportDataJSON.AddExportButton
3. Click Run
4. The crimson "Export data.json" button will appear near cell M2 on the "Executive Summary (Print)" sheet


CHARTS NOT LOADING (Chart.js file missing)
---------------------------------------------

Cause: chart.umd.min.js is missing from the repository or the shared drive folder.

Note: As of February 2026, Chart.js is hosted locally (no CDN dependency). The file chart.umd.min.js should be in the same folder as index.html.

Solution:
1. Check that chart.umd.min.js exists in the repository root (same folder as index.html)
2. If missing, download it from: https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js
3. Save it as chart.umd.min.js in the repository root
4. Commit and push to GitHub


VBA MACRO MODULE IS MISSING FROM EXCEL
----------------------------------------

Cause: The VBA module was not imported into the workbook, or was lost when the workbook was saved as .xlsx (which strips macros).

Solution:
1. Ensure the workbook is saved as .xlsm (macro-enabled format)
2. Press Alt+F11 to open the VBA Editor
3. In the Project Explorer pane, right-click the workbook name
4. Select Import File...
5. Browse to ExportDataJSON.bas and import it
6. Close the VBA Editor
7. Save the workbook as .xlsm


INDEX.HTML SHOWS BLANK PAGE WHEN OPENED FROM SHARED DRIVE
-----------------------------------------------------------

Cause: Opening index.html directly from the R: drive (or any local folder) uses the file:// protocol. Most browsers block fetch('data.json') over file:// due to security restrictions (CORS policy).

This is NOT a bug -- it is expected browser behavior.

Solution: The live dashboard is hosted on GitHub Pages, not the shared drive. Always access it at:
  https://jswsu.github.io/wsu-energy-dashboard/

The copy of index.html on the shared drive is there as a code backup/reference, not for direct viewing. If you ever need to view it locally (e.g., GitHub is down), use Firefox which is more permissive with file:// access, or run a local web server from the folder.


DASHBOARD SHOWS STALE DATA AFTER REFRESH
------------------------------------------

Cause: Browser is serving a cached version of data.json.

Solution:
1. Hard-refresh: Ctrl+Shift+R (clears cache for the current page)
2. If that doesn't work, open browser DevTools (F12) > Network tab > check "Disable cache" > refresh
3. As a last resort, clear the browser cache entirely
